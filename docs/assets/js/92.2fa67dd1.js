(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{689:function(t,v,r){"use strict";r.r(v);var _=r(4),n=Object(_.a)({},(function(){var t=this,v=t.$createElement,r=t._self._c||v;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("blockquote",[r("p",[t._v("原文请参考Cesium官方文档："),r("a",{attrs:{href:"https://cesium.com/docs/tutorials/cesium-unreal-flyto/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Transition Between Locations on the Globe"),r("OutboundLink")],1)])]),t._v(" "),r("blockquote",[r("p",[t._v("上一篇："),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-sublevels.html"}},[t._v("（五）Cesium for Unreal使用地理参考子关卡搭建全球场景（译）")])],1)]),t._v(" "),r("p",[t._v("在本教程中，您将学习使用虚幻引擎蓝图在"),r("strong",[t._v("Cesium for Unreal")]),t._v("全球的两个位置之间平滑地飞行。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://i.loli.net/2021/05/20/WBnKqHDbZrAeC1m.gif",alt:""}}),t._v(" "),r("em",[t._v("在悉尼和澳大利亚墨尔本之间穿梭")])]),t._v(" "),r("p",[t._v("您将学习如何：")]),t._v(" "),r("ul",[r("li",[t._v("在虚幻引擎中使用地图坐标")]),t._v(" "),r("li",[t._v("在各地创建视口")]),t._v(" "),r("li",[t._v("创建一个蓝图在各地穿梭")])]),t._v(" "),r("blockquote",[r("p",[t._v("蓝图是虚幻引擎内部的基于节点接口的可视化脚本系统。尽管掌握一些编码知识很有用，但"),r("strong",[t._v("蓝图")]),t._v("使非程序员也可以轻松地给应用程序添加逻辑。")])]),t._v(" "),r("h2",{attrs:{id:"准备工作"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),r("ul",[r("li",[t._v("知道如何创建一个基于"),r("strong",[t._v("Cesium for Unreal")]),t._v("的虚幻应用程序。请查阅"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-unreal-quickstart.html"}},[t._v("（一）Cesium for Unreal快速入门（译）")]),t._v("教程，以获取有关"),r("strong",[t._v("Cesium for Unreal")]),t._v("插件的入门指南。")],1)]),t._v(" "),r("h2",{attrs:{id:"第一步-创建一个虚幻关卡"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第一步-创建一个虚幻关卡"}},[t._v("#")]),t._v(" 第一步：创建一个虚幻关卡")]),t._v(" "),r("p",[t._v("从"),r("strong",[t._v("Cesium for Unreal")]),r("a",{attrs:{href:"https://www.unrealengine.com/marketplace/en-US/product/cesium-samples",target:"_blank",rel:"noopener noreferrer"}},[t._v("示例"),r("OutboundLink")],1),t._v("的"),r("strong",[t._v("01_CesiumWorld")]),t._v("关卡开始。")]),t._v(" "),r("blockquote",[r("p",[t._v("译者注：可以考虑复制一份"),r("strong",[t._v("01_CesiumWorld")]),t._v("关卡，打开复制的关卡，开始下面的操作。")])]),t._v(" "),r("ol",[r("li",[t._v("在"),r("strong",[t._v("World Outliner")]),t._v("中选择"),r("strong",[t._v("CesiumGeoreference")]),t._v(" Actor，然后在"),r("strong",[t._v("Details")]),t._v("面板中，查找"),r("strong",[t._v("Origin Longitude")]),t._v("，"),r("strong",[t._v("Origin Latitude")]),t._v("和"),r("strong",[t._v("Origin Height")]),t._v("属性。将它们设置为起始位置的值。例如，要从澳大利亚悉尼开始，我们可以输入以下坐标："),r("strong",[t._v("Origin Longitude")]),t._v("= 151.206696，"),r("strong",[t._v("Origin Latitude")]),t._v("= -33.871799，"),r("strong",[t._v("Origin Height")]),t._v("= 3000.0。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/19/YgETvfzoZwrPhaG.png",alt:""}})]),t._v(" "),r("li",[t._v("启用"),r("strong",[t._v("Keep World Origin Near Camera")]),t._v("参数，这将确保我们在整个飞行过程中镜头保持正确的方向。")])]),t._v(" "),r("h2",{attrs:{id:"第二步-添加floatingpawn-actor"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第二步-添加floatingpawn-actor"}},[t._v("#")]),t._v(" 第二步：添加"),r("strong",[t._v("FloatingPawn")]),t._v(" Actor")]),t._v(" "),r("blockquote",[r("p",[t._v("当镜头在"),r("strong",[t._v("Cesium")]),t._v("地球上各地之间飞行时，镜头应遵循与地球表面平行的弯曲路径，而不是线性的点对点轨迹。"),r("strong",[t._v("FloatingPawn")]),t._v("可以用来实现这种功能。")])]),t._v(" "),r("ol",[r("li",[t._v("将"),r("strong",[t._v("FloatingPawn")]),t._v("添加到场景中。如果您找不到它，请按照"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-unreal-quickstart.html#第三步-添加sunsky照明和floatingpawn"}},[t._v("此处")]),t._v("的说明进行操作。要定位到刚添加的"),r("strong",[t._v("FloatingPawn")]),t._v("，请在"),r("strong",[t._v("World Outliner")]),t._v("中双击其标签。这个Pawn看起来应该像这样：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/his72ej3ABxE6FS.png",alt:""}}),t._v("\n由于绑定了镜头，因此可以在编辑器右下角通过镜头预览场景。使用虚幻引擎中的平移和旋转控件调整"),r("strong",[t._v("FloatingPawn")]),t._v("的初始位置和旋转角度。")],1),t._v(" "),r("li",[t._v("在"),r("strong",[t._v("Details")]),t._v("面板中，搜索"),r("strong",[t._v("possess")]),t._v("。选择"),r("strong",[t._v("Auto Possess Player")]),t._v("旁边的下拉菜单，然后选择"),r("strong",[t._v("Player 0")]),t._v("。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/dJGNRUtfFr4YZ7X.png",alt:""}}),t._v("\n现在在运行模式下，您将能够使用鼠标和键盘"),r("strong",[t._v("WASD")]),t._v("键控制"),r("strong",[t._v("FloatingPawn")]),t._v("了。")])]),t._v(" "),r("blockquote",[r("p",[t._v("玩家"),r("strong",[t._v("Player")]),t._v("是您在运行模式下控制的实体。您可以使用"),r("strong",[t._v("Player")]),t._v("在场景中移动并执行其他操作。如果场景中有多个"),r("strong",[t._v("Player")]),t._v("，您也可以在不同的"),r("strong",[t._v("Player")]),t._v("之间切换。")])]),t._v(" "),r("h2",{attrs:{id:"第三步-在蓝图中设置穿梭功能"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第三步-在蓝图中设置穿梭功能"}},[t._v("#")]),t._v(" 第三步：在蓝图中设置穿梭功能")]),t._v(" "),r("p",[t._v("在此步骤中，您将创建一个蓝图函数，该函数让我们按下键盘上的按钮后，在地球上的两个位置之间飞行。")]),t._v(" "),r("ol",[r("li",[t._v("点击虚幻引擎编辑器工具栏上的"),r("strong",[t._v("Blueprints")]),t._v(" -> "),r("strong",[t._v("Open Level Blueprint")]),t._v("按钮，打开关卡蓝图。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/izKRvdsw2nyjVgU.png",alt:""}})]),t._v(" "),r("li",[t._v("从"),r("strong",[t._v("World Outliner")]),t._v("中，选择"),r("strong",[t._v("FloatingPawn")]),t._v(" Actor。将"),r("strong",[t._v("FloatingPawn")]),t._v("拖放到关卡蓝图中的"),r("strong",[t._v("Event Graph")]),t._v("中。从"),r("strong",[t._v("FloatingPawn")]),t._v("节点拖出一根连线，然后查找"),r("strong",[t._v("Inaccurate Fly to Location Longitude Latitude Height")]),t._v("节点。此函数是本教程的核心，让我们可以输入目的地。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/YcyUAXTQbV1fj9W.png",alt:""}}),t._v("\n如果想知道这个函数如何工作的，可以将鼠标悬停在这个函数的节点上查看详细说明。该函数的参数之一是"),r("strong",[t._v("Can Interrupt By Moving")]),t._v("，它是该函数节点上的最后一个引脚。如果您希望能够使用WASD键在飞行中移动"),r("strong",[t._v("Pawn")]),t._v("，则可以勾选参数旁边的复选框。")])]),t._v(" "),r("blockquote",[r("p",[t._v("蓝图目前不支持双精度。之所以该函数称为"),r("strong",[t._v("Inaccurate Fly to Location Longitude Latitude Height")]),t._v("，是因为为了将该函数暴露给"),r("strong",[t._v("蓝图")]),t._v("（译者注：蓝图不支持双精度浮点数），所以它的输入参数使用了单精度而不是双精度来计算值。在"),r("strong",[t._v("GlobeAwareDefaultPawn.h")]),t._v("头文件中，还有一个名为"),r("strong",[t._v("FlyToLocationLongitudeLatitudeHeight")]),t._v("的函数，可在C++代码中用双精度计算。")])]),t._v(" "),r("ol",{attrs:{start:"3"}},[r("li",[t._v("右键点击"),r("strong",[t._v("Event Graph")]),t._v("中的空白区域，然后添加一个"),r("strong",[t._v("Make Vector")]),t._v("节点。将目的地的经度、纬度和高度的值分别输入到X，Y和Z参数中。在本教程中，我们将飞往经度= 144.9631，纬度= -37.8136，高度= 2000的澳大利亚墨尔本。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/2QChuvpxfydLZHR.png",alt:""}})]),t._v(" "),r("li",[t._v("要触发穿梭功能，请添加一个键盘事件，并将其输出引脚连接到"),r("strong",[t._v("Inaccurate Fly to Location Longitude Latitude Height")]),t._v("节点的输入引脚。下面的示例使用F键。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/gZBlWUX17pM9z48.png",alt:""}})]),t._v(" "),r("li",[t._v("点击编辑器工具栏左上角的"),r("strong",[t._v("Compile")]),t._v("按钮，编译新添加的节点。\n要检查所有设置是否正确，请返回主编辑器。点击顶部工具栏上的"),r("strong",[t._v("Play")]),t._v("按钮。初始视图应该与我们之前通过"),r("strong",[t._v("Floating Pawn")]),t._v("的镜头预览看到的视图相同。按键盘上的F键（或你选择的任意键）以查看飞行情况。\n镜头将以相对较直的路径非常快速地在悉尼和墨尔本之间移动。在下一步中，您将设置一些变量以自定义整个穿梭过程中"),r("strong",[t._v("FloatingPawn")]),t._v("的速度和高度。")])]),t._v(" "),r("h2",{attrs:{id:"第四步-自定义穿梭"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第四步-自定义穿梭"}},[t._v("#")]),t._v(" 第四步：自定义穿梭")]),t._v(" "),r("p",[t._v("在这一步中，我们将调整"),r("strong",[t._v("FloatingPawn")]),t._v(" Actor的一些参数，以自定义pawn如何穿梭到目的地。第一个任务是添加一些"),r("strong",[t._v("Fly To Curves")]),t._v("。")]),t._v(" "),r("blockquote",[r("p",[r("strong",[t._v("Fly To Curves")]),t._v("是"),r("strong",[t._v("UCurveFloat")]),t._v(" Actor，用于在计算"),r("strong",[t._v("Pawn")]),t._v("从起始位置到达结束位置所经过的路径时，给"),r("strong",[t._v("Inaccurate Fly to Location Longitude Latitude Height")]),t._v("提供输入参数。")])]),t._v(" "),r("p",[t._v("在创建"),r("strong",[t._v("Fly To Curves")]),t._v("时，我们有如下考虑：")]),t._v(" "),r("ul",[r("li",[r("strong",[t._v("Pawn")]),t._v("从起始位置拉升其高度，拉远镜头，然后移动到目标位置，然后再拉近镜头。此行为由"),r("strong",[t._v("Fly To Altitude Profile Curve")]),t._v("控制。该曲线必须在两个轴上都保持在0到1的范围内。")]),t._v(" "),r("li",[t._v("根据垂直移动距离，"),r("strong",[t._v("Pawn")]),t._v("需要保持在最大高度范围内。例如，如果"),r("strong",[t._v("Pawn")]),t._v("升高12,000公里，那么我们将最大高度设置为3,000公里。如果升高18公里，最大海拔高度要小得多，为9.3公里。我们通过"),r("strong",[t._v("Fly To Maximum Altitude Curve")]),t._v("来实现此行为。")]),t._v(" "),r("li",[t._v("为了让速度随着时间变化，我们需要使用"),r("strong",[t._v("Fly To Progress Curve")]),t._v("。这里x是时间，y是曲线上的位置。")])]),t._v(" "),r("h3",{attrs:{id:"设置fly-to-curves"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#设置fly-to-curves"}},[t._v("#")]),t._v(" 设置"),r("strong",[t._v("Fly To Curves")])]),t._v(" "),r("ol",[r("li",[r("p",[t._v("右键单击"),r("strong",[t._v("Content Browser")]),t._v("中的任意位置，然后选择"),r("strong",[t._v("Miscellaneous —> Curve —> CurveFloat")]),t._v("。点击"),r("strong",[t._v("Select")]),t._v("并为其命名。双击新创建的曲线以导航到"),r("strong",[t._v("Curve Editor")]),t._v("。您应该在y = 0处看到一条直线：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/tiXKZdq21yOhcYf.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("右键单击曲线，然后选择"),r("strong",[t._v("Add Key")]),t._v("以创建新的控制点。在曲线上添加三个控制点，使其看起来如下所示：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/RYgsb3iPWLpyIu9.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("同时选择所有三个关键点，并从顶部工具面板中点击"),r("strong",[t._v("cubic interpolation")]),t._v("三次曲线插值，还有"),r("strong",[t._v("toggle weighted tangents for cubic interpolation modes")]),t._v("：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/pHzlKvhY4B3WSQ2.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("通过选择关键点并移动其手柄来修改曲线的形状。最终得到一条在x轴上从-1到1，在y轴上从0到1的曲线：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/LtlZnVBHquiNfmy.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("按照上述步骤，设置其余曲线，即"),r("strong",[t._v("Fly to Maximum Altitude Curve")]),t._v("和"),r("strong",[t._v("Fly to Progress Curve")]),t._v("。以下是其余曲线的曲线选项和最终结果：\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/vfG8KeyO5QxniSF.png",alt:""}}),t._v(" "),r("em",[t._v("Fly to Maximum Altitude Curve曲线形状和曲线选项")]),t._v(" "),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/kAZRuCT2yVnOwa4.png",alt:""}}),t._v(" "),r("em",[t._v("Fly to Progress Curve曲线形状和曲线选项")])])]),t._v(" "),r("li",[r("p",[t._v("对曲线的形状满意后，将它们设置到我们前面添加的"),r("strong",[t._v("FloatingPawn")]),t._v(" Actor的"),r("strong",[t._v("Details")]),t._v("面板中的相应属性上。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/ilQG7pb1zdM9KWH.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("导航回到主编辑器，然后点击"),r("strong",[t._v("Play")]),t._v("。再次按F键启动飞行。请注意仔细观察"),r("strong",[t._v("Pawn")]),t._v("是如何先快速上升到一定高度，然后缓慢地飞到目的地，然后迅速降落到最终位置的。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/WBnKqHDbZrAeC1m.gif",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("您也可以通过在"),r("strong",[t._v("Details")]),t._v("面板中的"),r("strong",[t._v("Fly to Curve")]),t._v("参数下的"),r("strong",[t._v("Fly to Duration")]),t._v("参数来修改跳跃速度。该值确定跳跃需要多长时间，因此该值越高，跳跃就越慢。")])])]),t._v(" "),r("h2",{attrs:{id:"第五步-飞往geo-markers地理标记"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第五步-飞往geo-markers地理标记"}},[t._v("#")]),t._v(" 第五步：飞往"),r("strong",[t._v("geo-markers地理标记")])]),t._v(" "),r("p",[t._v("输入起点和终点WGS84坐标来指定飞跃并不总是很方便。在某些情况下，可以通过放置"),r("strong",[t._v("geo-markers地理标记")]),t._v("来避免这种情况。这些标记可以用来表示目标位置，能直接放置在Cesium地球上。")]),t._v(" "),r("ol",[r("li",[r("p",[t._v("首先，只需将立方体放置在地球上的任何地方，这便是您的目标地理标记。如果需要，请右键单击该对象，然后单击"),r("strong",[t._v("Snap Object To View")]),t._v("以将目标地理标记与编辑器镜头的当前位置和方向完全一致。到目前为止，您应该非常熟悉在世界范围内移动编辑器镜头并"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-placing-objects.html"}},[t._v("放置对象")]),t._v("。如果您在"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-sublevels.html"}},[t._v("子关卡")]),t._v("教程之后尝试本教程，请确保将立方体添加到"),r("strong",[t._v("Persistent Level")]),t._v("。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/YovLnuiX4NF5S8f.jpg",alt:""}}),t._v(" "),r("em",[t._v("在此示例中，将立方体设置为悬停在波士顿上方")])],1)]),t._v(" "),r("li",[r("p",[t._v("将立方体的移动性设置为"),r("strong",[t._v("Movable")]),t._v("。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/xCXKrbaN42PBksn.jpg",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("将"),r("strong",[t._v("CesiumGeoreferenceComponent")]),t._v("添加到立方体中，此组件将帮助提供和维护此立方体的全球定位功能。要了解有关在"),r("strong",[t._v("Cesium for Unreal")]),t._v("中地理绑定的更多信息，请参见"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-placing-objects.html"}},[t._v("此处")]),t._v("。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/sUmnpdfeOHlw3yE.jpg",alt:""}})],1)]),t._v(" "),r("li",[r("p",[t._v("现在，再次打开"),r("strong",[t._v("关卡蓝图")]),t._v("。在"),r("strong",[t._v("Event Graph")]),t._v("中为键盘"),r("strong",[t._v("G")]),t._v("键添加一个新的键盘事件。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/mM6FSdqOtQaLJog.jpg",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("和之前一样，将"),r("strong",[t._v("FloatingPawn")]),t._v("拖拽到Graph中。这次，从"),r("strong",[t._v("FloatingPawn")]),t._v("拉出连线，然后搜索"),r("strong",[t._v("Inaccurate Fly to Location ECEF")]),t._v("节点。将执行引脚从键盘G事件连接到"),r("strong",[t._v("Inaccurate Fly to Location ECEF")]),t._v("节点的执行引脚。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/ulO1przbjPsUwKi.jpg",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("将立方体和默认的"),r("strong",[t._v("CesiumGeoreference")]),t._v("从"),r("strong",[t._v("World Outliner")]),t._v("拖到"),r("strong",[t._v("关卡蓝图")]),t._v("中。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/hBNfYpVbj21H7RG.jpg",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("从"),r("strong",[t._v("CesiumGeoreference")]),t._v("节点拉出连线，然后搜索"),r("strong",[t._v("Inaccurate Transform Ue to Ecef")]),t._v("节点。从立方体拉出连线，搜索"),r("strong",[t._v("GetActorLocation")]),t._v("函数。将立方体的虚幻坐标连接到"),r("strong",[t._v("Inaccurate Transform Ue to Ecef")]),t._v("。将这个函数的输出连接到"),r("strong",[t._v("Inaccurate Transform Ue to Ecef")]),t._v("。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/pZwQzhL15bIRUnJ.jpg",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("点击"),r("strong",[t._v("Play")]),t._v("，然后按"),r("strong",[t._v("G")]),t._v("键尝试一下。通过修改"),r("strong",[t._v("Inaccurate Transform Ue to Ecef")]),t._v("中的"),r("strong",[t._v("Yaw")]),t._v("和"),r("strong",[t._v("Pitch")]),t._v("属性，可以根据自己的喜好调整终点镜头的方向。为了能够通过手动移动"),r("strong",[t._v("Pawn")]),t._v("来取消正在进行的跳跃，请勾选"),r("strong",[t._v("Can Interrupt By Moving")]),t._v("复选框。\n"),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/SYn1voFxqmtU4Wk.gif",alt:""}}),t._v(" "),r("em",[t._v("FloatingPawn从丹佛飞往波士顿")]),t._v(" "),r("img",{attrs:{src:"https://i.loli.net/2021/05/20/MmVU2vN4Eh79lT6.jpg",alt:""}})])])]),t._v(" "),r("h2",{attrs:{id:"下一步"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#下一步"}},[t._v("#")]),t._v(" 下一步")]),t._v(" "),r("p",[t._v("继续阅读"),r("RouterLink",{attrs:{to:"/views/Blog/cesium/cesium-flight-tracker.html"}},[t._v("使用Cesium for Unreal创建航班追踪器")]),t._v("教程。")],1),t._v(" "),r("p",[t._v("都看到这里了，加个技术交流群一起组队研究呗^^")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://i.loli.net/2021/05/09/HzUyekM3QNoblKv.png",alt:""}})])])}),[],!1,null,null,null);v.default=n.exports}}]);